using Microsoft.VisualStudio.TestTools.UnitTesting;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace Titanis.Security.Kerberos.Test;

[TestClass]
public class Trace_Aes256Test2
{
	public TestContext TestContext { get; set; }

	[TestMethod]
	public void TraceTest()
	{
		var logger = new KerberosDiagnosticLogger(new TestLog(this.TestContext));
		KerberosClient client = new KerberosClient(null, callback: logger);
		KerberosPasswordCredential cred = new KerberosPasswordCredential("milchick", "LUMON.IND", "Br3@kr00m!");
		var keyBytes = BinaryHelper.ParseHexString("bf0ff1d9446a72f0aba40d91668588a071a592c846d2a0496bc6c7959f45e1ad");
		var ticketSessionKey = client.CreateSessionKeyFor(EType.Aes256CtsHmacSha1_96, keyBytes);
		client.Trace(cred,
			ticketSessionKey,
			ApReq,
			ApRep,
			ApRep2,
			MechList,
			InitiatorMechListMic,
			AcceptorMechListMic,
			Request0,
			null
			);
	}


	#region AS-REQ
	private static readonly byte[] Asreq = BinaryHelper.ParseHexString("3081eba103020105a20302010aa3633061304ca103020102a24504433041a003020112a23a0438e6f50e931b558f7d7e1e972df51e4b68967cc3ce2bd63a32b7c273718acc8fe59cc380316bdde12878c87bad14b9e0806a9d69962293a8ea3011a10402020080a20904073005a0030101ffa47a3078a00703050040810010a1153013a003020101a10c300a1b086d696c636869636ba20b1b094c554d4f4e2e494e44a31e301ca003020102a11530131b066b72627467741b094c554d4f4e2e494e44a511180f31393730303130313030303030305aa7060204f5e9b84aa80e300c020112020111020117020118");
	#endregion
	#region AS-REP
	private static readonly byte[] Asrep = BinaryHelper.ParseHexString("30820649a003020105a10302010ba22b30293027a103020113a220041e301c301aa003020112a1131b114c554d4f4e2e494e446d696c636869636ba30b1b094c554d4f4e2e494e44a4153013a003020101a10c300a1b086d696c636869636ba58204b2618204ae308204aaa003020105a10b1b094c554d4f4e2e494e44a21e301ca003020102a11530131b066b72627467741b094c554d4f4e2e494e44a382047430820470a003020112a103020102a28204620482045ee0d8a37104a478dd49c5c7980bd6cea30c3a915d1b378e0c4a816e985c0affdd80a84de0e5f6fe1200ab2a8c4dc89318bd2d74456518b9b47be3b18a09b1c34fc07ddeedebe750b97d93127947c94274eb7e905456673e9070937b7ecc3a83c2e06cb77849f5724d2bd3c2025d8051864ff9e1784be33d59ace5f9bc97369532a5cab98bab7df9d0851a993676ddc4b9838a0eeb99efdbf91c53d5440074bd985f288353c63432a073525baa19995186453ca732161adf9b3ba48107eab7ec5c4b4e06e833d389440198dbd396190c9facb6778dbfc235d1b95895b1a1ecb64d421dc39ab06afc3a57aea295f3119f56da88cd91df7aacb6ed4398466e1d7fd9c9e5200f9f3a7f3e8e83afdff039a349ac570db91aadcbce1f8584e17f4e68a5d14d61f6f5acacea6d728383a6b74ec7e530965ec452c112b92d07ab44dffb384fec548d46acd4eb97bdd9af6ee8a10fe17f3e149ce49a2231ce97cb9381c38bf5cccb8e648de6f6f3f9d0ff2e8e5c7403d9692c1c3830bb2a93c904e7a1ea47f8d25c231d5be6e51bd3bf2f35d88531e8328dcf4214371fc0847389b5e5af6f3bb3b31c938039ea12106b67f2c2c793fec350d9c2de37485183b74ac71e6bae1cc572d828047e5b531e3b6dca24b564c74716ffb6db078609083afa6fc4c48a1b0a0abc6cb5aa5c42bd85ebd899a9496358f3b0539705aebd04956bd5d381da8c2c9115b9808be5fa67c8c02809e6995ccb0678b5dfa1e8e268b54f3a94e8327bc66421152f108f6234f2a6c0163515b88531c47886f33e0b8bc661360883a161f1ae8f3e06eda642b09c13743366845844e9686e1623853082b54b62b90c7b4df2da76069a34ff97164c9ae0c18e4a4496af6cd013bd2c966f3bdbacbd92e484140e22042912954414deced38dc5a23def0f72d0bf5942e1780a2a97e13d61c23ce10f2c321bf43ecad61e90aead532be5aaa255464a9a49d542bc38aad4fdf51b2b4b788838500f2e896c37c9caefcd55d8ad77bc991e8eda826be091bee85d57c4a08f0c12b7707fb848c24dd1caccef9c838b4dc43b4f33a2f89f318eb69b9c6ee9f02f7aab02500abe35243b1581c4dcd1ec96cf1f6e15ad0861d2eb6d9e8abe9167052f917ea4c1d413219ed0537b4f8625b33e6520c3097ab8bc24d84bb5a66f40bf4605f32bf62fa45028003c51d8c1e9c8fe03b8d563f0aae6a857121445577f6d382704ccddf5ce54dab12f910250ce6d1b749df2a1281013525da21350327e18efd8ffe344a3cb14125cde35b047e572499833e0f3773a7e59d95ca030969565445fae7d9764076d617ab6a556877299e0d08184df28721ff43406285681ef10db2d681fc5afc42c9874927673a946e3ac002fda0993a3f6f661d3dfcd0092fef1423b3baf634ff706226101564e06914a5330c0daf18081f13553829502c3c7b2ccde11ce36a46795cfe12275edbdfbae97dd7611c90eda8916515c8f2194c045a2860c250aaba8b0b3b53b3fb516532e2047569d6e91ec7ead2e258d2348bb749287f6afb244c43fdc6666d8f821cc142ba5d13fbb0251a682013430820130a003020112a103020105a28201220482011e8d45e6727cb4f68987999831352cbf910457a9f40c5189d06e82926ff039aed79ae2dbaa061ccfa39f79e150dd9ae0e0e5c9c2716f6816b44731590e258cec398d1b7e1b27ec9b50a9c9860988c04c7c756e53208b376fa8e07027a190be40f34eb4d2a5d21a49a98014ffbf794d18742fc47dd725b0e8e8e249837cb5d74e978f32f66d90c4209693f92b2f9ac43a3586a6ad65060aab2fec5237abd6608f7262293a92646045fec7f57f960341f761562f8f414e6620219498af1ba8e636062f4b7ca9a696c49ccf9eef7c2ef849cfc0f5f215d742097031c0c5d5748346e409720e8c3b03fbf2f83532ab1d663bb3f5f526f3c34c951cf8d693b68d90dc46c35dc5924cd4adb513a15df413c9c4fe0bede5eb98081c330e5918b508e6");
	#endregion
	#region TGS-REQ
	private static readonly byte[] TgsReq = BinaryHelper.ParseHexString("3082061ea103020105a20302010ca38205963082059230820577a103020101a282056e0482056a6e82056630820562a003020105a10302010ea20703050000000000a38204b2618204ae308204aaa003020105a10b1b094c554d4f4e2e494e44a21e301ca003020102a11530131b066b72627467741b094c554d4f4e2e494e44a382047430820470a003020112a103020102a28204620482045ee0d8a37104a478dd49c5c7980bd6cea30c3a915d1b378e0c4a816e985c0affdd80a84de0e5f6fe1200ab2a8c4dc89318bd2d74456518b9b47be3b18a09b1c34fc07ddeedebe750b97d93127947c94274eb7e905456673e9070937b7ecc3a83c2e06cb77849f5724d2bd3c2025d8051864ff9e1784be33d59ace5f9bc97369532a5cab98bab7df9d0851a993676ddc4b9838a0eeb99efdbf91c53d5440074bd985f288353c63432a073525baa19995186453ca732161adf9b3ba48107eab7ec5c4b4e06e833d389440198dbd396190c9facb6778dbfc235d1b95895b1a1ecb64d421dc39ab06afc3a57aea295f3119f56da88cd91df7aacb6ed4398466e1d7fd9c9e5200f9f3a7f3e8e83afdff039a349ac570db91aadcbce1f8584e17f4e68a5d14d61f6f5acacea6d728383a6b74ec7e530965ec452c112b92d07ab44dffb384fec548d46acd4eb97bdd9af6ee8a10fe17f3e149ce49a2231ce97cb9381c38bf5cccb8e648de6f6f3f9d0ff2e8e5c7403d9692c1c3830bb2a93c904e7a1ea47f8d25c231d5be6e51bd3bf2f35d88531e8328dcf4214371fc0847389b5e5af6f3bb3b31c938039ea12106b67f2c2c793fec350d9c2de37485183b74ac71e6bae1cc572d828047e5b531e3b6dca24b564c74716ffb6db078609083afa6fc4c48a1b0a0abc6cb5aa5c42bd85ebd899a9496358f3b0539705aebd04956bd5d381da8c2c9115b9808be5fa67c8c02809e6995ccb0678b5dfa1e8e268b54f3a94e8327bc66421152f108f6234f2a6c0163515b88531c47886f33e0b8bc661360883a161f1ae8f3e06eda642b09c13743366845844e9686e1623853082b54b62b90c7b4df2da76069a34ff97164c9ae0c18e4a4496af6cd013bd2c966f3bdbacbd92e484140e22042912954414deced38dc5a23def0f72d0bf5942e1780a2a97e13d61c23ce10f2c321bf43ecad61e90aead532be5aaa255464a9a49d542bc38aad4fdf51b2b4b788838500f2e896c37c9caefcd55d8ad77bc991e8eda826be091bee85d57c4a08f0c12b7707fb848c24dd1caccef9c838b4dc43b4f33a2f89f318eb69b9c6ee9f02f7aab02500abe35243b1581c4dcd1ec96cf1f6e15ad0861d2eb6d9e8abe9167052f917ea4c1d413219ed0537b4f8625b33e6520c3097ab8bc24d84bb5a66f40bf4605f32bf62fa45028003c51d8c1e9c8fe03b8d563f0aae6a857121445577f6d382704ccddf5ce54dab12f910250ce6d1b749df2a1281013525da21350327e18efd8ffe344a3cb14125cde35b047e572499833e0f3773a7e59d95ca030969565445fae7d9764076d617ab6a556877299e0d08184df28721ff43406285681ef10db2d681fc5afc42c9874927673a946e3ac002fda0993a3f6f661d3dfcd0092fef1423b3baf634ff706226101564e06914a5330c0daf18081f13553829502c3c7b2ccde11ce36a46795cfe12275edbdfbae97dd7611c90eda8916515c8f2194c045a2860c250aaba8b0b3b53b3fb516532e2047569d6e91ec7ead2e258d2348bb749287f6afb244c43fdc6666d8f821cc142ba5d13fbb0251a48196308193a003020112a2818b048188c836d4564ba00cc1b7e566b0a3eb019f1f0abc2ff7ddd8b99e850c67bd37ec5e1d7d05f1b81ee0ae7f458bc46c90069df9438ada792eb368b882ecc9a3a11eaa2e3e9f5a59d2be684e096b630a78cf8549ac81f6fee391f8b61b7a8fa909357da4a15a0c8b161b422ec92c7c8615d7624a7e44c78bfccf0ae9847f38a06249fbecc4e20373cb4c423015a104020200a7a20d040b3009a00703050040000000a4783076a00703050040810000a1153013a003020101a10c300a1b086d696c636869636ba20b1b094c554d4f4e2e494e44a31c301aa003020102a11330111b04484f53541b094c554d4f4e2d444331a511180f31393730303130313030303030305aa7060204dcbd214aa80e300c020112020111020117020118");
	#endregion
	#region TGS-REP
	private static readonly byte[] TgsRep = BinaryHelper.ParseHexString("30820638a003020105a10302010da30b1b094c554d4f4e2e494e44a4153013a003020101a10c300a1b086d696c636869636ba58204d0618204cc308204c8a003020105a10b1b094c554d4f4e2e494e44a21c301aa003020102a11330111b04484f53541b094c554d4f4e2d444331a382049430820490a003020112a103020109a28204820482047eb6e4f73543057adbc795cf33a19804f67b917eab37228d6254d1e3d7b629b77beee27a34996c35cad55510aa174642008a90adeaeaa8ca0ce6524cff0dee765bd0b6c7837b8fdb6f66a2a581d6f0f0df413475722161e2782378ca2f9d02fca6ebf46f91e96df05818c58a5c89b14da103b9b9084d032b9f913123e7ff041fced2efaaa8764d5f85087bc6b92230cacb0858949ea929b0842c094a5eb917c4be7fba06f7a0d8e38bb2f596948a2c090376d1a25fe54f6ddb355aabbb360f9e32000fb4ddb552696f12a22c2f7f72d9a13716f0501aed9a7bf917e9ea3daa67a6506e40f2a23a3a7281adcc4fecd18cec5a9ab1baba754fe8f66cba6d88a663036ee370bf54ee90e8d6742dce1b6eece9a933dc67f373e23c31fb95ebed1eb06a8c78ed4c3df3c981746ba7a51e489e7621da64f205173100eb0963702b8edfda0d153c2cbd50176521579549ef3d24af1785fb4299fe5581f3892b1cb3782de14c959f7048bd80f69838dab84e51b95640144e1c718030cc527655a99e5984267487925cbf50c328c0bc8d0d44f8a3f76be93a563899ee9fa6ce68232d4c42b98ce520d321ae0cd3d18ec23744c81c1d16555836893afed86970dfb9d3cc2e601acbba7cea1938faa3e1dca2c16e4d8e58a7dcb6f2a8be2a432e75a396ffd7c0bf9d47239f5b9ce5782b341bd0ffb77faf52b17bdf52fab330370967417cd268f50b2d51813609e39f125d3a36b250d3d7529ae0c868408666d8aae7efe6af7f196cfb3458c3bc72388ce66c21e7b2a654af96d3b531db8038aee33c7bb9008e0f0ee09276aaa1e30598bbe332af80efd3ebfb608814bce28835d00865f9ec03e392112bcd2c4a9bba04662b4496ed1bab41aacc88c96d1b5f25ab1d8e9fa3f117de2b6552de4292053e3232baf168dcfba7a26b17b5f0eac16c0a88a1a7d727d9f8ceb6212a78e1f9f850f4e97944f271424ac30e0c7913f34d50ce40d8e1f2179fbdebb4703627237252e07040fd72d81c1aa300605cfd8e285b12673b23de65ec9330e861ebcd6676e1134e72afa049cbbab6a8d6b237ed8be549fd86fe1d631e2cadb00da692db9f7f02ae8d02874e289abba489e565b2dc84e8682e477b81e58acc875bedf06a394ec7a97029efe05fcb72f3f5b97d7c7803e5ca92b69279c2aa0b5174f9157a0b9008278efd1c81be2363d84af1e2e15baa9218f209068e5752ca06fbf533370e12c0e3864956d92233f7b868d6cb606fa819ae912337856508086e228a3e7b80aba5248436ee99856dd94ae66c8658d905b7b58c4905c5c93f9f03008aff6604d50a95a421f6584155a9eeda01c994787804adfd9ac83d02811689c9a921528cc84e65c599bdb2a02096f00fd95ce9adade752e4888c182ebdf178af1c44db3c464c3dcb9da2de2be39610b84dd6dd638e151d93609a5adc75f4ab0109d8640fe7340f92e0a948eff8101b67431bd1cbf38bd2c660cb9789279d542718bd450aa587058902afce5f15da5eca89fa0e1f370bdbf63fb1db59031d084e8519ef80e3a3072c9166ec9fe28b931b7e8e117b18fca8711613017c8616a44449f1d503835ae53b8a4248a86ff1b8e9b9b4d046c2558b9ea68201323082012ea003020112a282012504820121b48ebbbab8ab5766847bd983242e5ae3a0704fea64def7e3641acb8b682028ff0a783f6afd96746c53e536335f76155aff3bd1d074502dfd7cf1ea637a8c9beb0e927f1ce0b48e1d732ae2a3163c53d1ca56daf1e9fb2686d43ff431b5bbce2fc8e04afac751005af3b11ab37ffb7005839c8983649575639cdfe49dbb5f55fdd93f476218f8d51215cd0207cdefcc5f7de75cbd8b2a7849d711d25fe46dad63a52b6761f5d427807b244f89562984f5069966e34b30344eb227461886f67bd4e7af899683caa842c38d4b83af346e4456abd7d7cf7a638cbf1c832d1d33edaf6f5b946a7fa1499f307697365aeeb5903e364e01bf0cfb5a890c063aea94dc3dc177dabf5a34f3825b8ed3a7891d47ed71f251316e5a3995f4a50e6a8ef30ee9f1");
	#endregion
	#region AP-REQ
	private static readonly byte[] ApReq = BinaryHelper.ParseHexString("308205b9a003020105a10302010ea20703050020000000a38204d0618204cc308204c8a003020105a10b1b094c554d4f4e2e494e44a21c301aa003020102a11330111b04484f53541b094c554d4f4e2d444331a382049430820490a003020112a103020109a28204820482047ed7b4076f60a25d2ca85dcef75468a2986f06428074ef4e0c2c4da4647882d30946606be38f8aee9dea6102b8d583b66286edf2c918856546da167b02552c22f99d0547aac5e5f85af12fc33d42d6f500c15d926ff7c829108e8f77887987002e4baad7822ebbaf16efa727017e020f658d7c470d99cf7e628364ccb62d8a661e2770b8955d1445d298b33647b53059e79b42d95adad693d8299e1236ee847041ddd58617dd7d10613c08d61fb89087f465fb8f8c464b52519dec781b6ca5b2835abb6d705636b7ca4216c8addd1cf64052370013f4d572158c67803825f94c575972f88ed18793e995d1023c91c32bf930c3c4d613e3a289654ea3b5136e351fd66a4c5f41107a04732085e418117fd72912f4ee4f3870ac30220e139c4ad880b69f462ad2ab183adc684d616d9363409b72ede1c714c479ffb75569c7520bb5623b49a8773cc367f540e8908aaa8a07ea9a0c79482d4383fe82e65f09e177f8ab127e1133a899fc5d27607828441f39547c0cadc9a0ee345f3350ae6cb0610980ab7c792867c9de77feb90be835747be14e7c7c3dcc26efc1b3dd6a09dfb5ed031d0d5cba4f7f282088afb231d1fd5d10be7d63a079601c04385a505ef6c4fa2bc25aaac777cba35e9d1633a45bc005ac2e8ebb02becc5b7c533feb7526f9631ff4f70c7d0e96a1a45a4aea61896e2e70e4f8d3772a4b30a8975a605fb0ee750b119a55d96b845576621f5638063526507b33da3270709da4c589e6fdb57ef08a0c27c46f5ed243f1c51da195fdcbc29dba36d380f79f8b598d200b7571e5ebd72350a0c9ef49e03bbef31b45681ee1f2088bf96e78272854421cf707acdcee6fe4846d3238f05e90ec1f86bb440fd99afef9b71f36ea8c76f67cc7bde2cf15d35a52c46113edaed61080371ec3ec0e3fbef743de22739084fa4eabb2b594f547fb97a89a09455015a2d02569571e2f89ae7808fbd006f1bce274ed3642cd27acec675fda5329ec79e96f902f2c9ece06f1ca62153969c8d8e1bc4dbda1bd7ca1ed6c1a2c676a507e3d4f599a274b29fbb7298e9fdc5f8a1b997a254862e18863995f0a4f1463ad67a1d18841470546b5a2dc9d44344c1c5584d901924bef608befa107f15d222c2afc328899e44acb716bed9a57018aaa5a1bc28d91bf12084962cf44ebfe2b076b4751d90642b5bc4217accf8ec8ac561edfe5242bf0b5e0c9a320ad1a199cf4c76d49f0a0c4471cbb7cd3a3a29e8953e9e09e25da116ecc8d2f455ef55c89503320ba12882b0b73858b43a28dafa374a053d22aa424c444cb7f3d42fca977d07fa326d2a60d8b9f879920db733eb28f7f2180245924644c100a00534456a178e95bae9ac98d7294d92ebbf8df4af9889139610fb53676b175e8d7e2a3fec6e15d4325437d793ba5fce5cc5a4c577810dabd8d6fd90027876305d27f8f4526253617fc79f35aeff5614667795d07f4fd8e4b691ea283bcf4ea43ceb46a590c5b40e8441fc9ec8c3beb5c443312c81b0402c864156b7230458a6121199b9d8a5334ad51c76b8e1c63aa76feccc498104cfd93959920d2b384aee7a36e65d4a5f58a69e2537fbda137fae597db6eaa86735d530d04c7a9a481cf3081cca003020112a281c40481c1ad2c5d19813262e36f9310d987fcd424265d85ec894e036127bb40fc7a0fa9eefb362541de477f8f12b8656ffc4a6e171f660228ba950240efb208e011425af05f5d66360d9019c9368f4e887a3b831dc11a6e79d2f6f203414464f1642972dce29b950dd7e0bd83163d49d1eef07abf2ed5dba537dd79b7142b69ae1917a078406450d975b32a58f4aa3b9c9c15f7549a1e11a623d39d8ce466fb993a7965b796aae00d612df4c9c463a749791366a22923e7a37bf755ac802a52bc4b23fdfb82");
	#endregion
	#region mechList
	private static readonly byte[] MechList = BinaryHelper.ParseHexString("301706092a864882f712010202060a2b06010401823702020a");
	#endregion
	#region AP-REP
	private static readonly byte[] ApRep = BinaryHelper.ParseHexString("308186a003020105a10302010fa27a3078a003020112a271046f6bb9a15180623ba2654214cda788b90208757e0f34abde193e1e2672078cfcc1f806c622b122c6798ac355ac6b415f72c0508d3be802755d9225b678730ba7f9c5adbc5799aaae149e7b750f6b08f99bd59ece7c6d0e540116ce6407adb7a101b1487be4ef9af75512841a1459b52b");
	#endregion
	#region AP-REP2
	private static readonly byte[] ApRep2 = BinaryHelper.ParseHexString("3059a003020105a10302010fa24d304ba003020112a2440442a9ee0f7ca45cdff9e9f615726b838f10541f38e42cf7aee84214e5e54530d8416abac811b05819d80f4a742d5522b1c9f5d8fd58056dbdc63ea4011b81573e52cee5");
	#endregion
	#region InitiatorMechListMic
	private static readonly byte[] InitiatorMechListMic = BinaryHelper.ParseHexString("040404ffffffffff000000007d04964dc8926f054ee66c8db50a24a0");
	#endregion
	#region AcceptorMechListMic
	private static readonly byte[] AcceptorMechListMic = BinaryHelper.ParseHexString("040405ffffffffff0000000010a872d65a6a94e38a0d2a0178eb5e5c");
	#endregion
	#region Req 0
	private static readonly byte[] Request0 = BinaryHelper.ParseHexString("0500000310000000b4004c00020000003c00000000004000337a552bbf5319fa7976aefb771f9fd076c9b54cae78e8b0df6e50f9da845796bd0d8ec165c2b136eab281ef6b3470310eb5f4683297cb75f055504d7aa8abe2c619183e360dd1ce09060c0000000000050406ff0010001c000000007d04964e3a585c1b4d3b3108ad1d5d2b9e9f36908b6ed096018f37d4ae059a2dfc9bf05905f4a8098559e8ee17afc2a512e87fa4aa3f6b29829b71a398af6150");
	#endregion
}
